<main class="container">
    <p>
        <a routerLink="/lobby" class="btn btn-default">Back to lobby</a>
    </p>
    <button *ngIf='inSync==false' class="btn btn-default">Sync</button>
    <div class="row">
        <section class="col-sm-12 col-md-8">
            <div id="play-area" class="blank" style="">
                <div class="wrapper">
                        <video id="video-player" #videoPlayer controls 
                            *ngIf="stream != null"
                            [currentTime]="streamTime"
                            (play)="playStream(videoPlayer.currentTime)" 
                            (pause)="pauseStream(videoPlayer.currentTime)" 
                            (seeking)="seekStream(videoPlayer.currentTime)"
                        >
                            <source src="{{url}}">
                        </video>
                    <audio></audio>
                    <img class="hidden">
                </div>
            </div>
            <form (ngSubmit)="streamUrl()" *ngIf="isHost | async">
                <div class="form-group">
                    <div class="input-group">
                        <label class="input-group-addon" for="url">url:</label>
                        <input [(ngModel)]="url" name="url" class="form-control">
                        <span class="input-group-btn">
                            <button type="submit" class="btn btn-default">Load</button>
                        </span>
                    </div>
                </div>
            </form>
        </section>
        <section class="col-sm-12 col-md-4 room-data">
            <div *ngIf="tab == 'chat'">
                <ul class="nav nav-tabs">
                    <li class="active"><a (click)="switchTab('chat')">Chat</a></li>
                    <li><a (click)="switchTab('history')">History</a></li>
                    <li><a (click)="switchTab('users')">Users</a></li>
                </ul>
                    <form (ngSubmit)='sendChatMessage()'>
                        <div class="form-group">
                            <div class="input-group">
                                <input [(ngModel)]="chatText" name="text" type="text" class="form-control">
                                <span class="input-group-btn">
                                    <button class="btn btn-default">Send</button>
                                </span>
                            </div>
                        </div>
                    </form>
                <div class="chat">
                    <div *ngFor="let entry of chat | async">
                        <div><b *ngIf="entry.user != null">{{entry.user}}:</b> {{entry.message}}</div>
                        <div></div>
                    </div>
                </div>
            </div>
            <div *ngIf="tab == 'history'">
                <ul class="nav nav-tabs">
                    <li><a (click)="switchTab('chat')">Chat</a></li>
                    <li class="active"><a (click)="switchTab('history')">History</a></li>
                    <li><a (click)="switchTab('users')">Users</a></li>
                </ul>
            </div>
            <div *ngIf="tab == 'users'">
                <ul class="nav nav-tabs">
                    <li><a (click)="switchTab('chat')">Chat</a></li>
                    <li><a (click)="switchTab('history')">History</a></li>
                    <li class="active"><a (click)="switchTab('users')">Users</a></li>
                </ul>
                <div class="users">
                    <div *ngFor="let username of users | async">{{username}}</div>
                </div>
            </div>
        </section>
    </div>
</main>